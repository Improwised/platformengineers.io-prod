<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Best Practices for Writing Dockerfiles | Platform Engineers</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" http-equiv="Content-Language" content="en"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" name="author" content="Platform Engineers"><meta data-n-head="ssr" name="copyright" content="Platform Engineers"><meta data-n-head="ssr" name="robots" content="index, follow"><meta data-n-head="ssr" name="theme-color" content="#179bfd"><meta data-n-head="ssr" name="application-name" content="Platform Engineers"><meta data-n-head="ssr" name="msapplication-TileColor" content="#FFFFFF"><meta data-n-head="ssr" name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png"><meta data-n-head="ssr" name="msapplication-square70x70logo" content="/img/favicon/ms-icon-70x70.png"><meta data-n-head="ssr" name="msapplication-square144x144logo" content="/img/favicon/ms-icon-144x144.png"><meta data-n-head="ssr" name="msapplication-square150x150logo" content="/img/favicon/ms-icon-150x150.png"><meta data-n-head="ssr" name="msapplication-square310x310logo" content="/img/favicon/ms-icon-310x310.png"><meta data-n-head="ssr" name="description" content="Docker has become an essential tool for developers and system administrators, providing a lightweight and portable way to package and distribute applications. | Platform Engineers"><meta data-n-head="ssr" name="title" content="Best Practices for Writing Dockerfiles | Platform Engineers"><meta data-n-head="ssr" property="og:type" content="website"><meta data-n-head="ssr" property="og:url" content="https://platformengineers.io/blog/best-practices-for-writing-dockerfiles/"><meta data-n-head="ssr" property="og:title" content="Best Practices for Writing Dockerfiles | Platform Engineers"><meta data-n-head="ssr" property="og:description" content="Docker has become an essential tool for developers and system administrators, providing a lightweight and portable way to package and distribute applications. | Platform Engineers"><meta data-n-head="ssr" property="og:image" content="https://platformengineers.io/_nuxt/image/52c62e.png"><meta data-n-head="ssr" property="twitter:card" content="summary"><meta data-n-head="ssr" property="twitter:site" content=""><meta data-n-head="ssr" property="twitter:creator" content=""><meta data-n-head="ssr" property="twitter:title" content="Best Practices for Writing Dockerfiles | Platform Engineers"><meta data-n-head="ssr" property="twitter:description" content="Docker has become an essential tool for developers and system administrators, providing a lightweight and portable way to package and distribute applications. | Platform Engineers"><meta data-n-head="ssr" property="twitter:image" content="https://platformengineers.io/_nuxt/image/52c62e.png"><link data-n-head="ssr" href="https://fonts.googleapis.com" rel="preconnect"><link data-n-head="ssr" href="https://maps.googleapis.com" rel="preconnect"><link data-n-head="ssr" href="https://www.gstatic.com" rel="preconnect"><link data-n-head="ssr" rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png"><link data-n-head="ssr" rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/img/favicon/favicon.ico"><link data-n-head="ssr" rel="icon" type="image/png" href="/img/favicon/favicon-16x16.png" sizes="16x16"><link data-n-head="ssr" rel="icon" type="image/png" href="/img/favicon/favicon-32x32.png" sizes="32x32"><link data-n-head="ssr" rel="icon" type="image/png" href="/img/favicon/favicon-96x96.png" sizes="96x96"><link data-n-head="ssr" rel="manifest" href="/manifest.json"><link data-n-head="ssr" rel="canonical" href="https://platformengineers.io/blog/best-practices-for-writing-dockerfiles/"><link data-n-head="ssr" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/monokai-sublime.min.css"><script data-n-head="ssr" type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Platform Engineers","alternateName":"Platform Engineers","url":"https://platformengineers.io/","image":"https://platformengineers.io/img/plateform-engineers.png","sameAs":[]}</script><link rel="preload" href="/_nuxt/23217b8.js" as="script"><link rel="preload" href="/_nuxt/0f88427.js" as="script"><link rel="preload" href="/_nuxt/css/64240c5.css" as="style"><link rel="preload" href="/_nuxt/990548d.js" as="script"><link rel="preload" href="/_nuxt/b4cbe7a.js" as="script"><link rel="preload" href="/_nuxt/css/998d57e.css" as="style"><link rel="preload" href="/_nuxt/1d8d9a4.js" as="script"><link rel="preload" href="/_nuxt/css/01649ec.css" as="style"><link rel="preload" href="/_nuxt/accecf1.js" as="script"><link rel="stylesheet" href="/_nuxt/css/64240c5.css"><link rel="stylesheet" href="/_nuxt/css/998d57e.css"><link rel="stylesheet" href="/_nuxt/css/01649ec.css"><link rel="preload" href="/_nuxt/static/1733319470/blog/best-practices-for-writing-dockerfiles/state.js" as="script"><link rel="preload" href="/_nuxt/static/1733319470/blog/best-practices-for-writing-dockerfiles/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1733319470/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div><link rel="stylesheet" type="text/css" href="/dist/main.min.css" media="all"> <link rel="stylesheet" type="text/css" href="/dist/fontsicon.min.css"></div> <a id="start" rel="nofollow" aria-label="start point of page" href="javscript:void(0);"></a> <div class="main-container blog"><div class="blog-bk"><div class="nav-container"><div class="bar bar--sm visible-xs"><div class="container"><div class="row align-items-center"><div class="col-3 col-md-2"><a href="/"><img src="/_nuxt/image/e7b705.png" alt="Platform Engineers" loading="lazy" title="Platform Engineers"></a></div> <div class="col-9 col-md-10 text-right"><a href="#" aria-label="toggle" data-toggle-class="#menu1;hidden-xs" class="hamburger-toggle"><i class="icon icon--sm stack-interface stack-menu"></i></a></div></div></div></div> <nav id="menu1" data-scroll-class="366px:pos-fixed" class="bar bar--sm bar-1 hidden-xs"><div class="container"><div class="row align-items-center"><div class="hidden-xs d-flex align-items-center"><div class="bar__module"><a href="/"><img src="/_nuxt/image/418082.png" width="68" height="55" alt="Platform Engineers" loading="lazy" title="Platform Engineers"></a></div></div> <div class="col text-right text-left-xs text-left-sm"><div class="bar__module"><ul class="menu-horizontal text-left"><li><a href="/">Home</a></li> <li><a href="/about-us/">About Us</a></li> <li class="dropdown"><span class="dropdown__trigger">Services</span> <div class="dropdown__container"><div class="container"><div class="row"><div class="mt-1 dropdown__content col-lg-3 col-md-4 col-sm-6 p-3"><ul class="menu-vertical"><li><a href="/assessment/">Cost Assessment</a></li> <li><a href="/assessment/">Performance Assessment</a></li> <li><a href="/services/platform-engineering/">Platform Engineering</a></li><li><a href="/services/kubernetes-consulting-services/">Kubernetes Consulting Services</a></li><li><a href="/services/containerization/">Containerization</a></li><li><a href="/services/performance-optimization/">Performance Optimization</a></li><li><a href="/services/ci-cd-implementation/">CI/CD Implementation</a></li><li><a href="/services/infrastructure-maintenance-and-support/">Infra Maintenance & Support</a></li></ul></div></div></div></div></li> <li class="dropdown"><span class="dropdown__trigger">Industries</span> <div class="dropdown__container"><div class="container"><div class="row"><div class="mt-1 dropdown__content col-lg-3 col-md-4 col-sm-6 p-3"><ul class="menu-vertical"><li><a href="/industries/IoT/">IoT</a></li><li><a href="/industries/ecommerce/">eCommerce</a></li><li><a href="/industries/fintech/">FinTech</a></li><li><a href="/industries/SaaS/">SaaS</a></li><li><a href="/industries/enterprise/">Enterprise</a></li></ul></div></div></div></div></li> <li><a href="/blog/">Blog</a></li> <li><a href="/case-studies/">Case Studies</a></li></ul></div> <div class="bar__module"><div><a href="/contact-us/" title="contact" class="btn btn--primary type--uppercase b-30"><span class="btn__text"> Contact us </span></a></div></div></div></div></div></nav></div> <div class="container"><div class="row py-2"><div class="col-md-6 d-flex align-items-center justify-content-center"><div><h1 class="h2 mb-0">Best Practices for Writing Dockerfiles</h1> <div class="lh-1 mb-3">
          Tue, 04/06/2024 |
          5 mins
        </div> <!----> <!----> <div class="row"><div class="col-lg-4 col-md-12"><div class="d-flex align-items-center mt-3"><div class="d-flex align-items-center mr-2" style="border-radius:200px"><img src="/_nuxt/image/a07868.png" width="32" height="40" alt="Best Practices for Writing Dockerfiles" title="Best Practices for Writing Dockerfiles" class="p-0 m-0 rounded author-s"></div> <div><strong class="m-0 p-0 lh-1">
                  Angita
                  Shah
                </strong></div></div></div><div class="col-lg-4 col-md-12"><div class="d-flex align-items-center mt-3"><div class="d-flex align-items-center mr-2" style="border-radius:200px"><img src="/_nuxt/image/32d461.png" width="32" height="40" alt="Best Practices for Writing Dockerfiles" title="Best Practices for Writing Dockerfiles" class="p-0 m-0 rounded author-s"></div> <div><strong class="m-0 p-0 lh-1">
                  Satish
                  Annavar 
                </strong></div></div></div></div> <!----></div></div> <div class="col-md-6 d-flex align-items-center justify-content-center"><img src="/_nuxt/image/3fcdfc.png" height="400" alt="Best Practices for Writing Dockerfiles | Platform Engineers" decoding="async" class="img-dim" style="color:transparent"></div></div></div></div> <section class="bg-- wave-bk-1 section-padding"><div class="container"><div class="row"><div class="col-lg-10 offset-lg-1 bs-11 p-5 b-30 bg-white"><div class="fc-lead ul-list"><p dir="ltr">Docker has become an essential tool for developers and system administrators, providing a lightweight and portable way to package and distribute applications. Writing a Dockerfile is the first step in creating a Docker image, and following best practices can help ensure that your images are efficient, secure, and easy to maintain. In this article, we will explore some of the most important best practices for writing Dockerfiles, with in-depth technical explanations.</p>
<h3 dir="ltr">1. Use a minimal base image</h3>
<p dir="ltr">The base image is the starting point for your Docker image, and it's important to choose one that is as small and minimal as possible. This will help reduce the size of your final image, which can improve build times and reduce storage costs.</p>
<p dir="ltr">For example, instead of using the <code>ubuntu</code> base image, which includes a full Linux distribution, you can use the <code>alpine</code> image, which is based on the lightweight Alpine Linux distribution. The <code>alpine</code> image is typically much smaller than the <code>ubuntu</code> image, which can result in faster build times and smaller image sizes.</p>
<pre><code>FROM alpine:latest</code></pre>
<h3 dir="ltr">2. Use multi-stage builds</h3>
<p dir="ltr">Multi-stage builds allow you to use multiple base images in a single Dockerfile, which can help reduce the size of your final image and improve build times. With multi-stage builds, you can use one base image to compile your application, and then copy the compiled binary to a smaller base image for deployment. </p>
<p dir="ltr">For example, you can use the <code>node:14-alpine</code> image to compile your Node.js application, and then copy the compiled binary to the <code>alpine</code> image for deployment. <a href="https://platformengineers.io/blog/multi-stage-build-for-ci-cd-pipeline-using-dockerfile/" target="_blank" rel="noopener">Read more here about multi stage build</a>.</p>
<pre><code># Build stage
FROM node:14-alpine as build


WORKDIR /app


COPY package.json yarn.lock ./
RUN yarn install


COPY . .
RUN yarn build


# Deploy stage
FROM alpine:latest


WORKDIR /app


COPY --from=build /app/dist ./dist


CMD ["node", "dist/index.js"]</code></pre>
<h3 dir="ltr">3. Use the <code>.dockerignore</code> file</h3>
<p dir="ltr">The <code>.dockerignore</code> file allows you to exclude files and directories from the build context, which can help reduce build times and improve security. By default, Docker includes the entire contents of the build context in the final image, which can result in large image sizes and potential security vulnerabilities.</p>
<p dir="ltr">For example, you can use the <code>.dockerignore</code> file to exclude the <code>node_modules</code> directory, which is not needed in the final image.</p>
<pre><code>node_modules/</code></pre>
<h3 dir="ltr">4. Use environment variables</h3>
<p dir="ltr">Environment variables allow you to configure your application at runtime, without hardcoding values in your code. This can help improve security and make it easier to manage your application in different environments.</p>
<p dir="ltr">For example, you can use environment variables to configure the database connection string for your application.</p>
<pre><code>ENV DATABASE_URL=postgresql://user:password@host:port/database</code></pre>
<h3 dir="ltr">5. Use the <code>COPY</code> command carefully</h3>
<p dir="ltr">The <code>COPY</code> command is used to copy files and directories from the build context to the Docker image. However, it's important to use it carefully, as it can result in large image sizes and potential security vulnerabilities.</p>
<p dir="ltr">For example, instead of copying the entire contents of your project directory, you can use the <code>.dockerignore</code> file to exclude unnecessary files and directories, and then copy only the files that are needed for your application.</p>
<pre><code>COPY package.json yarn.lock ./
RUN yarn install


COPY . .</code></pre>
<h3 dir="ltr">6. Use the <code>RUN</code> command to install dependencies</h3>
<p dir="ltr">The <code>RUN</code> command is used to execute commands in the Docker image. It's important to use it to install dependencies, rather than installing them manually on the host system. This can help ensure that your application is portable and consistent across different environments.</p>
<p dir="ltr">For example, you can use the <code>RUN</code> command to install the <code>build-essential</code> package, which is needed to compile C++ code.</p>
<pre><code>RUN apk add --no-cache build-essential</code></pre>
<h3 dir="ltr">7. Use the <code>ENTRYPOINT</code> command</h3>
<p dir="ltr">The <code>ENTRYPOINT</code> command is used to specify the command that should be executed when the Docker container starts. This can help ensure that your application starts correctly, and it can also make it easier to manage your application in different environments.</p>
<p dir="ltr">For example, you can use the <code>ENTRYPOINT</code> command to start your Node.js application.</p>
<pre><code>ENTRYPOINT ["node", "dist/index.js"]</code></pre>
<h3 dir="ltr">8. Use the <code>HEALTHCHECK</code> command</h3>
<p dir="ltr">The <code>HEALTHCHECK</code> command is used to specify a command that should be executed periodically to check the health of the Docker container. This can help ensure that your application is running correctly, and it can also help you identify and troubleshoot issues more quickly.</p>
<p dir="ltr">For example, you can use the HEALTHCHECK command to check that your web server is responding to requests.</p>
<pre><code>HEALTHCHECK --interval=5s --timeout=3s --retries=3 CMD curl --fail http://localhost:3000/healthz || exit 1</code></pre>
<h3 dir="ltr">9. Use the <code>USER</code> command</h3>
<p dir="ltr">The <code>USER</code> command is used to specify the user that should be used to run the Docker container. This can help improve security by reducing the privileges of the user running the container.</p>
<p dir="ltr">For example, you can use the <code>USER</code> command to switch to the <code>node</code> user, which has limited privileges.</p>
<pre><code>USER node</code></pre>
<h3 dir="ltr">10. Use the <code>VOLUME</code> command</h3>
<p dir="ltr">The <code>VOLUME</code> command is used to specify a directory that should be used to store data outside of the Docker container. This can help improve performance and make it easier to manage your data in different environments.</p>
<p dir="ltr">For example, you can use the <code>VOLUME</code> command to store your application's logs outside of the container.</p>
<pre><code>VOLUME ["/app/logs"]</code></pre>
<h3 dir="ltr">Conclusion</h3>
<p dir="ltr">Writing a Dockerfile is an important step in creating a Docker image, and following best practices can help ensure that your images are efficient, secure, and easy to maintain. By using a minimal base image, multi-stage builds, environment variables, and other best practices, you can create Docker images that are optimized for performance and security.</p></div> <hr> <div class="d-flex align-items-center flex-wrap"></div> <hr> <div class="article__share mt-0"><ul class="social-list list-inline list--hover blog_social" style="margin:0!important;padding:0!important"><li class="list-inline-item mr-0"><a href="javascript:void(0)" class="share-network-email"><i class="socicon socicon-google icon icon--xs"></i></a></li> <li class="list-inline-item mr-0"><a href="javascript:void(0)" class="share-network-linkedin"><i class="socicon socicon-linkedin icon icon--xs"></i></a></li> <li class="list-inline-item mr-0"><a href="javascript:void(0)" class="share-network-twitter"><i class="socicon socicon-twitter icon icon--xs"></i></a></li> <li class="list-inline-item mr-0"><a href="javascript:void(0)" class="share-network-facebook"><i class="socicon socicon-facebook icon icon--xs"></i></a></li> <li class="list-inline-item mr-0"><a href="javascript:void(0)" class="share-network-whatsapp"><i class="socicon socicon-whatsapp icon icon--xs"></i></a></li></ul></div></div></div></div></section></div> <footer class="pt-4 pb-0 footer-2 bg--dark" data-v-1a1e3611><div class="container" data-v-1a1e3611><div class="row" data-v-1a1e3611><div class="col-md-3 col-sm-6 col-12 mb-5" data-v-1a1e3611><h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Company</h3> <ul class="list--hover mb-1" data-v-1a1e3611><li data-v-1a1e3611><a href="/about-us/" data-v-1a1e3611>About Us</a></li></ul> <ul class="list--hover d-flex mt-2 icons" data-v-1a1e3611><li data-v-1a1e3611><a href="https://www.facebook.com/profile.php?id=61555276800801" title="Platform Engineers facebook page" target="_blank" data-v-1a1e3611><i class="socicon socicon-facebook icon icon--xs" data-v-1a1e3611></i></a></li> <li class="px-2" data-v-1a1e3611><a href="https://twitter.com/platform_engr" title="Platform Engineers twitter account" target="_blank" data-v-1a1e3611><i class="socicon socicon-twitter icon icon--xs" data-v-1a1e3611></i></a></li> <li class="px-1" data-v-1a1e3611><a href="https://www.linkedin.com/company/platform-engineers/mycompany/" title="Platform Engineers linkedin page" target="_blank" data-v-1a1e3611><i class="socicon socicon-linkedin icon icon--xs" data-v-1a1e3611></i></a></li></ul> <h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Resources</h3> <ul class="list--hover" data-v-1a1e3611><li data-v-1a1e3611><a href="/blog/" data-v-1a1e3611>Blog</a></li> <li data-v-1a1e3611><a href="/case-studies/" data-v-1a1e3611>Case Studies</a></li></ul></div> <div class="col-md-3 col-sm-6 col-12 mb-5" data-v-1a1e3611><h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Services</h3> <ul class="list--hover" data-v-1a1e3611><li data-v-1a1e3611><a href="/services/platform-engineering/" data-v-1a1e3611>Platform Engineering</a></li><li data-v-1a1e3611><a href="/services/kubernetes-consulting-services/" data-v-1a1e3611>Kubernetes Consulting Services</a></li><li data-v-1a1e3611><a href="/services/containerization/" data-v-1a1e3611>Containerization</a></li><li data-v-1a1e3611><a href="/services/performance-optimization/" data-v-1a1e3611>Performance Optimization</a></li><li data-v-1a1e3611><a href="/services/ci-cd-implementation/" data-v-1a1e3611>CI/CD Implementation</a></li><li data-v-1a1e3611><a href="/services/infrastructure-maintenance-and-support/" data-v-1a1e3611>Infra Maintenance & Support</a></li></ul></div> <div class="col-md-3 col-sm-6 col-12 mb-5" data-v-1a1e3611><h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Industries</h3> <ul class="list--hover" data-v-1a1e3611><li data-v-1a1e3611><a href="/industries/IoT/" data-v-1a1e3611>IoT</a></li><li data-v-1a1e3611><a href="/industries/ecommerce/" data-v-1a1e3611>eCommerce</a></li><li data-v-1a1e3611><a href="/industries/fintech/" data-v-1a1e3611>FinTech</a></li><li data-v-1a1e3611><a href="/industries/SaaS/" data-v-1a1e3611>SaaS</a></li><li data-v-1a1e3611><a href="/industries/enterprise/" data-v-1a1e3611>Enterprise</a></li></ul></div> <div class="col-md-3 col-sm-6 col-12 mb-5" data-v-1a1e3611><h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Support</h3> <ul class="list--hover" data-v-1a1e3611><li data-v-1a1e3611><a href="/contact-us/" data-v-1a1e3611>Contact Us</a></li></ul> <h3 class="type--uppercase m-0 h6" data-v-1a1e3611>Assessment</h3> <ul class="list--hover" data-v-1a1e3611><li data-v-1a1e3611><a href="/assessment/" data-v-1a1e3611>Cost Assessment</a></li> <li data-v-1a1e3611><a href="/assessment/" data-v-1a1e3611>Performance Assessment</a></li></ul></div></div></div> <div class="sub-footer mt-3" data-v-1a1e3611><div class="col-md-12 text-center" data-v-1a1e3611><span class="type--fine-print" data-v-1a1e3611>© <span class="update-year" data-v-1a1e3611></span> Platform Engineers</span></div></div></footer> <a href="#start" data-scroll-class="100vh:active" title="click & go to top of the page" aria-label="click & go to top of the page" class="back-to-top inner-link"><i class="stack-interface stack-up-open-big"></i></a></div></div></div><script defer src="/_nuxt/static/1733319470/blog/best-practices-for-writing-dockerfiles/state.js"></script><script src="/_nuxt/23217b8.js" defer></script><script src="/_nuxt/1d8d9a4.js" defer></script><script src="/_nuxt/accecf1.js" defer></script><script src="/_nuxt/0f88427.js" defer></script><script src="/_nuxt/990548d.js" defer></script><script src="/_nuxt/b4cbe7a.js" defer></script><script data-n-head="ssr" src="https://www.googletagmanager.com/gtag/js?id=G-LRC7N9VH4L" data-body="true"></script><script data-n-head="ssr" src="/google-tag.js" data-body="true"></script><script data-n-head="ssr" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" data-body="true"></script><script data-n-head="ssr" src="/js/hljs.js" data-body="true"></script>
  </body>
</html>
